(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4245a3a6"],{"358b":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"goodsList",on:{click:function(e){return t.getGoods()}}},[s("div",{on:{click:t.openModel}},[t._t("default")],2),s("a-modal",{attrs:{width:"80%",title:"商品列表"},on:{ok:t.selectGoods},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[s("div",{staticClass:"mb20 text-r"},[s("a-input-search",{staticStyle:{width:"22rem"},attrs:{enterButton:"",placeholder:"请输入名称搜索"},on:{search:t.onSearch}}),s("a-form-item",{staticStyle:{display:"inline-block","margin-left":"10px",width:"400px"},attrs:{label:"分类选择","label-col":{xs:{span:24},md:{span:6}},"wrapper-col":{xs:{span:24},md:{span:18}}}},[s("a-cascader",{staticStyle:{width:"100%"},attrs:{options:t.classTree,placeholder:"请选择分类",changeOnSelect:""},on:{change:t.changeClass}})],1)],1),t.listField&&t.listField.length>0?[s("a-table",{staticClass:"components-table-demo-nested",attrs:{rowKey:function(t){return t.id},scroll:{y:400,x:1200},rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange,type:t.seleteType},loading:t.tabLoading,columns:t.listField,dataSource:t.listData,pagination:!1},scopedSlots:t._u([{key:"goods_image",fn:function(t,e){return s("div",{},[s("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.goods_image,alt:""}})])}}],null,!1,828441971)}),s("div",{staticClass:"pages"},[s("a-pagination",{attrs:{total:t.pages.total,showTotal:function(t){return"共 "+t+" 条数据"},pageSize:Number(t.pages.per_page),defaultCurrent:1},on:{change:t.changePage}})],1)]:t._e()],2)],1)},o=[],a=(s("5ab2"),s("6d57"),s("e10e"),s("163d"),s("ce3c")),r=s("804d"),n=s("c1fb"),d=s("c968"),l=s("9f3a");function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function p(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var u={name:"goodsList",computed:p({},Object(l["c"])({classTree:function(t){return t.goods.goodsClassTree}})),data:function(){return{visible:!1,tabLoading:!0,params:{page:1,keyword:"",goods_state:1,gc_id_1:"",gc_id_2:"",gc_id_3:""},selectedRowKeys:[],ids:[],selection:[],listData:[],listField:[],pages:{},shopParams:{per_page:1e6,is_open:1}}},watch:{},props:{linkType:{type:String,default:"goods"},seleteType:{type:String,default:"checkbox"},maxNum:{type:Number,default:1e5},defaultKeys:{type:Array,default:function(){return[]}},otherParam:{type:Object,default:function(){}}},mounted:function(){this.defaultKeys.length>0&&(this.selectedRowKeys=this.defaultKeys),this.otherParam&&(console.log(this.otherParam),Object.assign(this.params,this.otherParam)),this.getClassTree()},methods:p(p({},Object(l["b"])({getClassTree:"goods/getGoodsClassTree"})),{},{changeClass:function(t){t.length>0?(this.params.gc_id_1=t[0],this.params.gc_id_2=t[1]||"",this.params.gc_id_3=t[2]||""):(this.params.gc_id_1="",this.params.gc_id_2="",this.params.gc_id_3="")},changePage:function(t){this.params.page=t,this.getGoods()},onSelectChange:function(t,e){if("checkbox"===this.seleteType){if(t.length>this.maxNum)return void this.$message.warning("最大选择数量为"+this.maxNum);this.selectedRowKeys=t;for(var s=0;s<e.length;s++)if(-1===this.ids.indexOf(e[s].id)){var i=[];"goods"===this.linkType?(i.id=e[s].id,i.goods_name=e[s].goods_name,i.goods_price=e[s].goods_price,i.goods_image=e[s].goods_image,this.selection.push(i)):this.selection.push(e[s]),this.ids.push(e[s].id)}for(var o=this.selection.length-1;o>=0;o--)-1===t.indexOf(this.selection[o].id)&&(this.selection.splice(o,1),this.ids.splice(o,1))}else this.selectedRowKeys=t,this.selection=e;this.$emit("selected",this.selection)},onSearch:function(t){this.params.page=1,this.params.keyword=t,this.getGoods()},getGoods:function(){var t=this;this.tabLoading=!0;var e=this.params,s="";s="goods"===this.linkType?r["a"].action.goods_lists:r["a"].action.secKillGoodList,n["a"].get(s,e).then((function(e){0===e.code?(t.listField=e.result.field,t.listField[0].width=50,t.listField[1].width=150,"goods"===t.linkType?t.listField[2].scopedSlots={customRender:"goods_image"}:t.listField[3].scopedSlots={customRender:"goods_image"},t.listField[2].width=120,t.listField[3].width=120,t.listField[4].width=120,t.listField[5].width=120,t.listField[6].width=120,t.listField[7].width=120,t.pages=e.result.lists,t.listData=e.result.lists.data,t.tabLoading=!1):d["a"].showError(e.message)})).catch((function(t){d["a"].showError(t)}))},openModel:function(){this.visible=!0},selectGoods:function(){this.visible=!1,this.$emit("selectOk",this.selection)}})},g=u,h=(s("970e"),s("9ca4")),m=Object(h["a"])(g,i,o,!1,null,"09624b16",null);e["a"]=m.exports},"3c7d":function(t,e,s){},5746:function(t,e,s){"use strict";var i=s("3c7d"),o=s.n(i);o.a},"970e":function(t,e,s){"use strict";var i=s("9765"),o=s.n(i);o.a},9765:function(t,e,s){},afa4:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mr24 coupon_show"},[t.formItem.id?t._e():s("a-card",{staticClass:"mb20",attrs:{title:"选择商品",bordered:!1}},[s("getGoods",{attrs:{seleteType:"radio"},on:{selectOk:t.getGoodsList}},[s("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"large"}},[t._v("选择商品")])],1)],1),t.tableData.length>0?s("a-card",{staticClass:"coupon-name",attrs:{title:"拼团活动信息"}},[s("a-row",{attrs:{type:"flex",align:"middle"}},[s("a-col",{staticClass:"add-label",attrs:{xs:{span:24},md:{span:3}}},[t._v("\n        拼团总人数：\n      ")]),s("a-col",{attrs:{xs:{span:24},md:{span:6,offset:1}}},[0===t.id?s("div",[s("a-input",{staticStyle:{width:"180px","margin-right":"5px"},attrs:{type:"number",placeholder:"不能超过6人"},on:{blur:t.checkSize},model:{value:t.formItem.group_size,callback:function(e){t.$set(t.formItem,"group_size",e)},expression:"formItem.group_size"}}),s("span",[t._v("人")])],1):s("span",[t._v(t._s(t.formItem.group_size)+"人")])])],1),s("a-row",{attrs:{type:"flex",align:"middle"}},[s("a-col",{staticClass:"add-label",attrs:{xs:{span:24},md:{span:3}}},[t._v("\n        拼团等待时间：\n      ")]),s("a-col",{attrs:{xs:{span:24},md:{span:6,offset:1}}},[0===t.id?s("div",[s("a-input",{staticStyle:{width:"180px","margin-right":"5px"},attrs:{type:"number",placeholder:"请输入整数小时"},model:{value:t.formItem.group_validhours,callback:function(e){t.$set(t.formItem,"group_validhours",e)},expression:"formItem.group_validhours"}}),s("span",[t._v("小时")])],1):s("span",[t._v(t._s(t.formItem.group_validhours)+"小时")])])],1),s("a-row",{attrs:{type:"flex",align:"middle"}},[s("a-col",{staticClass:"add-label",attrs:{xs:{span:24},md:{span:3}}},[t._v("\n        活动生效日期：\n      ")]),s("a-col",{attrs:{xs:{span:24},md:{span:7,offset:1}}},[0===t.id?s("a-range-picker",{attrs:{showTime:"",format:"YYYY/MM/DD HH:mm:ss"},on:{change:t.timeChange2}}):s("span",[t._v(t._s(t.formItem.start_time)+" ~ "+t._s(t.formItem.end_time))])],1)],1),t.is_rebate?s("a-row",{attrs:{type:"flex",align:"middle"}},[s("a-col",{staticClass:"add-label",attrs:{xs:{span:24},md:{span:3}}},[t._v("\n        推广佣金：\n      ")]),s("a-col",{attrs:{xs:{span:24},md:{span:6,offset:1}}},[0===t.id?s("div",[s("a-input",{staticStyle:{width:"180px","margin-right":"5px"},attrs:{type:"number",placeholder:"推广佣金"},model:{value:t.formItem.rewards,callback:function(e){t.$set(t.formItem,"rewards",e)},expression:"formItem.rewards"}}),s("span",[t._v("元")])],1):s("span",[t._v(t._s(t.formItem.rewards)+"元")])])],1):t._e()],1):t._e(),t.tableData.length>0?s("a-card",{attrs:{title:"商品规格信息填写",bordered:!1}},[s("a-table",{attrs:{columns:t.listField,dataSource:t.tableData,pagination:!1,rowKey:function(t){return t.sku_id},rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange,type:"checkbox",getCheckboxProps:t.setCheckboxProps}},scopedSlots:t._u([{key:"group_price",fn:function(e,i){return s("div",{},[s("a-input",{staticStyle:{width:"80%"},attrs:{disabled:-1!==t.sku_ids.indexOf(i.sku_id),placeholder:"请输入拼团金额",type:"number"},model:{value:i.group_price,callback:function(e){t.$set(i,"group_price",e)},expression:"item.group_price"}})],1)}}],null,!1,3145675600)}),t.formItem.id?t._e():s("p",{staticClass:"col-666 mt20"},[t._v("\n      *参加拼团的商品请在表格中勾选上，并且填上需要填的参数\n    ")]),t.formItem.id?t._e():s("div",{staticClass:"mt20"},[s("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("提交")]),s("a-button",{staticClass:"ml10",attrs:{type:"danger"},on:{click:function(e){return t.$router.back(-1)}}},[t._v("返回")])],1)],1):t._e()],1)},o=[],a=(s("5ab2"),s("e10e"),s("6d57"),s("ce3c")),r=s("9f3a"),n=s("358b");function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function l(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var c=[{dataIndex:"spec_sign",title:"规格名称",key:"spec_sign"},{dataIndex:"price",title:"商品价格",key:"price"},{dataIndex:"group_price",title:"拼团金额",key:"group_price",scopedSlots:{customRender:"group_price"}}],p={name:"coupon_show",components:{getGoods:n["a"]},computed:l({},Object(r["c"])({detail:function(t){return t.group.detail}})),data:function(){return{listField:c,id:0,selectedRowKeys:[],tableData:[],selectGoods:[],is_rebate:0,formItem:{start_time:"",end_time:"",group_size:"",group_validhours:"",goods_info:[]},goosItem:{group_stock:"",group_price:""},sku_ids:[],subThrottle:!1}},methods:l(l({},Object(r["b"])({groupApplySave:"group/groupApplySave",getDetail:"group/getDetail"})),{},{onSelectChange:function(t,e){this.selectedRowKeys=t},setCheckboxProps:function(t){var e=this;return this.formItem.id?(this.detail.GroupGoods.forEach((function(t){e.sku_ids.push(t.sku_id)})),{props:{disabled:-1!==this.sku_ids.indexOf(t.sku_id)}}):{}},initTable:function(t){var e=this;if(console.log(t),this.tableData=[],t.sku.id){var s={goods_name:t.goods_name,goods_id:t.id,sku_id:t.sku.id,spec_sign:"默认规格",price:t.goods_price,gc_id_3:t.gc_id_3,goods_image:t.goods_image,group_price:""};this.tableData.push(s)}else t.sku.forEach((function(s){var i={goods_name:t.goods_name,goods_id:t.id,sku_id:s.id,spec_sign:s.spec_sign,price:s.price,gc_id_3:t.gc_id_3,goods_image:t.goods_image,group_price:""};e.tableData.push(i)}))},checkSize:function(t){if(this.formItem.group_size>6)return this.formItem.group_size="",void this.$message.info("拼团人数不能大于6");this.formItem.group_size<=1&&(this.formItem.group_size="",this.$message.info("拼团人数最少为2"))},getGoodsList:function(t){console.log(t),this.selectGoods=t},timeChange2:function(t,e){this.formItem.start_time=e[0],this.formItem.end_time=e[1]},handleSubmit:function(){var t=this;this.subThrottle||(setTimeout((function(){t.subThrottle=!1}),1e3),this.subThrottle=!0,0!==this.selectedRowKeys.length?(this.formItem.goods_info=[],this.selectedRowKeys.forEach((function(e){var s=t.tableData.filter((function(t){return t.sku_id===e}));t.formItem.goods_info.push(s[0])})),this.groupApplySave({formItem:this.formItem})):this.$message.warning("请勾选参加砍价的商品规格，并填写完整信息"))},initData:function(){this.formItem={id:this.detail.Group.id,goods_id:this.detail.Group.goods_id,gc_id_3:this.detail.Group.gc_id_3,goods_name:this.detail.Group.goods_name,goods_price:this.detail.Group.goods_price,group_price:this.detail.Group.goods_price,goods_image:this.detail.Group.goods_image,group_desc:this.detail.Group.group_desc,start_time:this.detail.Group.start_time,end_time:this.detail.Group.end_time,group_size:this.detail.Group.group_size,group_validhours:this.detail.Group.group_validhours,goods_info:this.detail.GroupGoods,sort:0},this.detail.Group.rewards&&(this.is_rebate=1,this.formItem.rewards=this.detail.Group.rewards,this.formItem.profit_sharing=this.detail.Group.profit_sharing),this.tableData=this.detail.GroupGoods}}),watch:{selectGoods:function(){var t=this.selectGoods[0];this.formItem={goods_id:t.id,gc_id_3:t.gc_id_3,goods_name:t.goods_name,goods_price:t.goods_price,group_price:t.goods_price,goods_image:t.goods_image,group_desc:"123",start_time:"",end_time:"",group_size:"",group_validhours:"",goods_info:[],sort:0},1==t.is_rebate&&(this.is_rebate=1,this.$set(this.formItem,"rewards",""),this.$set(this.formItem,"profit_sharing","")),this.initTable(t)},detail:function(){this.initData()}},mounted:function(){void 0!==this.$route.params.id&&(this.id=this.$route.params.id,this.formItem.id=this.$route.params.id,this.getDetail({id:this.$route.params.id}))}},u=p,g=(s("5746"),s("9ca4")),h=Object(g["a"])(u,i,o,!1,null,"79a70054",null);e["default"]=h.exports}}]);