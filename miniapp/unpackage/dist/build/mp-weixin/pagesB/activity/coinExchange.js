require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesB/activity/coinExchange"],{"0257":function(t,o,n){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=e(n("669a"));function e(t){return t&&t.__esModule?t:{default:t}}var u=function(){n.e("node-modules/_@dcloudio_uni-ui@1.2.5@@dcloudio/uni-ui/lib/uni-load-more/uni-load-more").then(function(){return resolve(n("fdd7"))}.bind(null,n)).catch(n.oe)},r={mixins:[i.default],components:{uniLoadMore:u},onShow:function(){},mounted:function(){this.getGroupItem();var t=this;setTimeout((function(){t.visable=!0}),2e3)},onReachBottom:function(){var t=this;this.listParam.page===this.listParam.last?this.loadStatus="noMore":(this.listParam.page++,setTimeout((function(){t.loadStatus="loading",t.getIntegral()}),600))},data:function(){return{alreadyBlur:!1,myCoin:0,timer:null,oxCoin:0,pointProportion:0,oxCoinProportion:0,visable:!1,num:"",myPoint:0,act_title:"兑成牛币",gm_id:"",groupItems:[],currentGroup:"",is_choose:!1,submit:!1}},methods:{iptBlur:function(t){var o=t.target.value;o%this.pointProportion!==0&&(o-=o%this.pointProportion,this.num=o)},changExchangePoint:function(t){var o=this,n=t.target.value;return n=1==n.length?n.replace(/[^1-9]/g,""):n.replace(/[^\d]/g,""),o.oxCoin=parseInt(n/o.pointProportion)*o.oxCoinProportion,o.num=n,{value:n}},getRefreshCoin:function(){var t=this;this.$http({aurl:"refreshSelfPoint",data:{gm_id:this.gm_id||1},success:function(o){0===o.data.code&&(t.myCoin=o.data.result.point)},fail:function(t){console.log(t)},complete:function(){}})},gotoRecord:function(){t.navigateTo({url:"/pagesB/activity/exchangeRecord"})},onSelect:function(t){this.currentGroup=t.platform_name,this.gm_id=t.gm_id,this.pointProportion=t.use_obtain_point.use_point,this.oxCoinProportion=t.use_obtain_point.obtain_point,this.getRefreshPoint(),this.is_choose=!1},selectProject:function(){this.is_choose=!0},closeProjrct:function(){this.is_choose=!1},getRefreshPoint:function(){var t=this;this.$http({aurl:"refreshPoint",data:{gm_id:this.gm_id},success:function(o){0===o.data.code&&(t.myPoint=o.data.result.point,t.visable=!0)},fail:function(o){console.log(o),setTimeout((function(){t.visable=!0}),2e3)},complete:function(){}})},getGroupItem:function(){var o=this;this.$http({aurl:"platformPointList",success:function(n){if(0===n.data.code&&(o.groupItems=n.data.result,o.groupItems.length>0&&!o.currentGroup)){var i=t.getStorageSync("gmToken"),e=!1;if(i)for(var u=0;u<o.groupItems.length;u++)i==o.groupItems[u].gm_id&&(o.currentGroup=o.groupItems[u].platform_name,o.gm_id=o.groupItems[u].gm_id,o.pointProportion=o.groupItems[u].use_obtain_point.use_point,o.oxCoinProportion=o.groupItems[u].use_obtain_point.obtain_point,e=!0);i&&e||(o.currentGroup=o.groupItems[0].platform_name,o.gm_id=o.groupItems[0].gm_id,o.pointProportion=o.groupItems[0].use_obtain_point.use_point,o.oxCoinProportion=o.groupItems[0].use_obtain_point.obtain_point),o.getRefreshPoint(),o.getRefreshCoin()}},fail:function(t){console.log(t)},complete:function(){}})},toRefresh:function(){this.visable=!1;this.getRefreshPoint()},exchangeCoin:function(){var t=this;if(!this.submit){if(0==this.num)return wx.showToast({title:"请输入有效积分!",icon:"none"}),!1;if(this.myPoint<this.num)return wx.showToast({title:"输入积分大于已有积分!",icon:"none"}),!1;if(this.oxCoin<=0)return wx.showToast({title:"兑换牛币必须大于1!",icon:"none"}),!1;this.act_title="兑换中",this.submit=!0;var o=this;this.$http({aurl:"exchangeSelfPoint",data:{source_point:this.num,add_point:this.oxCoin,current_gm_id:this.gm_id},success:function(o){0===o.data.code&&(t.act_title="兑成牛币",t.getRefreshPoint(),t.oxCoin=0,t.num="",wx.showToast({title:"兑换成功!",icon:"success",duration:1500}))},fail:function(t){console.log(t),wx.showToast({title:"兑换失败!",icon:"none",duration:1500})},complete:function(){o.submit=!1}})}}}};o.default=r}).call(this,n("543d")["default"])},"18dc":function(t,o,n){"use strict";var i,e=function(){var t=this,o=t.$createElement;t._self._c},u=[];n.d(o,"b",(function(){return e})),n.d(o,"c",(function(){return u})),n.d(o,"a",(function(){return i}))},"6a00":function(t,o,n){"use strict";var i=n("ea3a"),e=n.n(i);e.a},"77d8":function(t,o,n){"use strict";(function(t){n("cf0c");i(n("66fd"));var o=i(n("c671"));function i(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,n("543d")["createPage"])},c671:function(t,o,n){"use strict";n.r(o);var i=n("18dc"),e=n("cbab");for(var u in e)"default"!==u&&function(t){n.d(o,t,(function(){return e[t]}))}(u);n("6a00");var r,s=n("f0c5"),a=Object(s["a"])(e["default"],i["b"],i["c"],!1,null,"1da6b9f6",null,!1,i["a"],r);o["default"]=a.exports},cbab:function(t,o,n){"use strict";n.r(o);var i=n("0257"),e=n.n(i);for(var u in i)"default"!==u&&function(t){n.d(o,t,(function(){return i[t]}))}(u);o["default"]=e.a},ea3a:function(t,o,n){}},[["77d8","common/runtime","common/vendor"]]]);