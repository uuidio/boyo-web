require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesB/activity/groupDetail"],{"263b":function(t,e,s){"use strict";var i=s("2d5d"),u=s.n(i);u.a},"2d5d":function(t,e,s){},"4aac":function(t,e,s){"use strict";(function(t){s("cf0c");i(s("66fd"));var e=i(s("cab3"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("543d")["createPage"])},9848:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u(s("0cb3"));function u(t){return t&&t.__esModule?t:{default:t}}var o=function(){s.e("node-modules/_@dcloudio_uni-ui@1.2.5@@dcloudio/uni-ui/lib/uni-count-down/uni-count-down").then(function(){return resolve(s("b840"))}.bind(null,s)).catch(s.oe)},n=function(){s.e("components/bottom-popup/bottom-popup").then(function(){return resolve(s("b022"))}.bind(null,s)).catch(s.oe)},a=function(){s.e("components/numberbox/numberbox").then(function(){return resolve(s("5a8b"))}.bind(null,s)).catch(s.oe)},c={mixins:[],components:{uniCountdown:o,tuiBottomPopup:n,tuiNumberbox:a},data:function(){return{downSecond:0,btnClick:!1,detail:{},show:!1,bn:0,goods_id:"",sku:[],skuKey:"",skuSelect:[],skuLists:[],goodsSkuItem:{},value:1,groupDetail:{},allGroupSkuName:[],popupShow:!1,skuIndex:0,disableBtn:!1,skuImgs:[],skuImgUrl:""}},onShow:function(){this.bn&&this.getGroupDetail(this.bn)},onLoad:function(t){this.bn=t.groups_bn},methods:{hidePopup:function(){this.popupShow=!1},showSkuMedal:function(){this.popupShow=!0},change:function(t){this.value=t.value},skuActive:function(t,e,s){var i=this.groupDetail.spec_name.indexOf("颜色");i===t&&this.skuImgs[e]&&this.skuImgs[e].length>0&&(this.skuImgUrl=this.skuImgs[e][0].url),this.sku[t].active=e,this.skuSelect[t]=s,this.skuActiveChange()},skuActiveChange:function(){if(-1===this.skuSelect.indexOf("占位")){this.skuKey="";var t=this;this.skuSelect.forEach((function(e){t.skuKey+=e+"_"})),t.skuKey=t.skuKey.slice(0,t.skuKey.length-1),this.skuIndex=this.skuLists.indexOf(t.skuKey),-1===this.skuIndex?(this.disableBtn=!0,this.showAlert("该规格未参与拼团，请选择其他商品规格")):this.disableBtn=!1,this.goodsSkuItem=this.groupDetail.group_spec_list[this.skuIndex],this.value=1}},initSku:function(){if(this.sku=[],this.skuKey="",this.skuSelect=[],this.goodsSkuItem=this.groupDetail.group_spec_list[0],this.value=1,null!==this.groupDetail.goods_spec){for(var t=0;t<this.groupDetail.spec_name.length;t++){var e={title:"",lists:[],active:-1};if(e.title=this.groupDetail.spec_name[t],this.groupDetail.goods_spec[t].value)for(var s=0;s<this.groupDetail.goods_spec[t].value.length;s++)e.lists.push(this.groupDetail.goods_spec[t].value[s]);else for(var i=0;i<this.groupDetail.goods_spec[t].length;i++)e.lists.push(this.groupDetail.goods_spec[t][i]);"颜色"===this.groupDetail.spec_name[t]&&this.groupDetail.goods_spec[t].imgs&&(this.skuImgs=this.groupDetail.goods_spec[t].imgs),e.lists.length>0&&this.sku.push(e),this.skuSelect.push("占位")}this.skuLists=this.groupDetail.group_spec_list.map((function(t){return t.spec_sign}))}},getAgentType:function(){var t=this;this.$http({aurl:"applyCheck",success:function(e){1===e.data.result.partner_info.is_purchaser&&1===e.data.result.partner_info.purchaser_status?t.show=!0:(t.showAlert("该商品需要采购员查看权限，2s后将为您跳转首页"),setTimeout((function(){t.toNav("/pages/index/index")}),2e3))},fail:function(t){console.log(t)},complete:function(t){}})},getSku:function(){var e=this;this.$http({aurl:"groupDetail",params:{id:this.goods_id},success:function(s){if(e.groupDetail=s.data.result,e.allGroupSkuName=[],e.groupDetail.group_spec_list.map((function(t){t.goods_spec&&t.goods_spec.map((function(t){e.allGroupSkuName.push(t)}))})),e.initSku(),88888===e.groupDetail.shop.id){var i=t.getStorageSync("user_token");if(!i)return e.toLink("/pagesB/user/bindUser"),!1;e.getAgentType()}else e.show=!0},fail:function(t){},complete:function(t){}})},submitOrder:function(){if(-1===this.skuSelect.indexOf("占位")){var e=this,s={actSign:"is_group",activity_id:this.goodsSkuItem.group_activty_id,quantity:this.value,type:"fastbuy",groups_bn:this.bn,sku_id:this.goodsSkuItem.id};this.$http({aurl:"addCart",data:s,success:function(s){t.setStorage({key:"type",data:"fastbuy",success:function(){e.needTokenLink("/pagesA/checkout/index")}})},fail:function(e){t.showToast({title:e.message.msg,icon:"none"}),console.log(e)}})}else t.showToast({title:"请选择完商品规格",icon:"none"})},timeUp:function(){t.showToast({title:"活动结束,下次早点来",icon:"none"}),this.btnClick=!1},getTime:function(t){var e=i.default.toTimeStamp(i.default.toFullTime())/1e3,s=i.default.toTimeStamp(t)/1e3;return s-e},getGroupDetail:function(e){var s=this;this.$http({aurl:"groupGoodsGroup",params:{groups_bn:e},success:function(t){s.detail=t.data.result,s.goods_id=s.detail.Group.goods_id,1===s.detail.GroupOrder.status&&(s.btnClick=!0),s.getSku()},fail:function(e){t.showModal({title:"温馨提示",content:"该拼团活动已经失效，无法参与拼团，请联系客服",confirmText:"知道了",showCancel:!1,success:function(e){t.switchTab({url:"/pages/index/index"})}})}})}},mounted:function(){}};e.default=c}).call(this,s("543d")["default"])},c6be:function(t,e,s){"use strict";var i,u=function(){var t=this,e=t.$createElement,s=(t._self._c,t.getTime(t.detail.GroupOrder.end_time));t.$mp.data=Object.assign({},{$root:{m0:s}})},o=[];s.d(e,"b",(function(){return u})),s.d(e,"c",(function(){return o})),s.d(e,"a",(function(){return i}))},cab3:function(t,e,s){"use strict";s.r(e);var i=s("c6be"),u=s("f0dd");for(var o in u)"default"!==o&&function(t){s.d(e,t,(function(){return u[t]}))}(o);s("263b");var n,a=s("f0c5"),c=Object(a["a"])(u["default"],i["b"],i["c"],!1,null,"12ca03b5",null,!1,i["a"],n);e["default"]=c.exports},f0dd:function(t,e,s){"use strict";s.r(e);var i=s("9848"),u=s.n(i);for(var o in i)"default"!==o&&function(t){s.d(e,t,(function(){return i[t]}))}(o);e["default"]=u.a}},[["4aac","common/runtime","common/vendor"]]]);