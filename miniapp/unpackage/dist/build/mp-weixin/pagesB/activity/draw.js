require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesB/activity/draw"],{"7f5e":function(t,e,i){"use strict";(function(t){i("cf0c");n(i("66fd"));var e=n(i("b03a"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},a76f:function(t,e,i){},aecf:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){Promise.all([i.e("pagesB/common/vendor"),i.e("pagesB/components/turntable/turntable")]).then(function(){return resolve(i("3b7c"))}.bind(null,i)).catch(i.oe)},a=function(){i.e("node-modules/_@dcloudio_uni-ui@1.2.5@@dcloudio/uni-ui/lib/uni-load-more/uni-load-more").then(function(){return resolve(i("fdd7"))}.bind(null,i)).catch(i.oe)},o=function(){i.e("components/modal/modal").then(function(){return resolve(i("3f8d"))}.bind(null,i)).catch(i.oe)},s=function(){i.e("components/explain/index").then(function(){return resolve(i("5cf8"))}.bind(null,i)).catch(i.oe)},c={name:"Home",components:{turntable:n,tuiModal:o,explain:s,uniLoadMore:a},onLoad:function(e){if(this.gm_id=e.gm_id,e.scene){var i=decodeURIComponent(e.scene),n=i.split("&");if(2===n.length){var a=n[0].substring(2);"c"===a&&(a="draw");var o=n[1].substring(3);this.act_id=o,this.prizeID=o,this.getLoot(),this.getRecordLists(!0),console.log(a+"-"+o),t.setStorage({key:"source",data:a,success:function(){}}),t.setStorage({key:"aid",data:o,success:function(){}})}}},onShow:function(){this.getLists(),this.getDesc(),this.getRefreshPoint()},data:function(){return{succImgUrl:"https://ytxspt.ytholidayplaza.com/images/cj-activity/choujiangBG.png",succGBUrl:"https://ytxspt.ytholidayplaza.com/images/cj-activity/choujiangGB.png",detail:{},ruleShow:!1,succShow:!1,canvasData:{width:320,height:320},drawDetail:{},prizeList:[],targetIndex:0,targetName:"",canvasImg:"",show:!1,point:0,act_id:"",prizeID:"",scrollTop:0,page:1,lists:[],loadStatus:"more",pullUpOn:!0,lastPage:1}},methods:{cancelModel:function(){this.$refs.raffleWheel.initFlag(),this.succShow=!1},getLoot:function(){var e=this;t.showLoading({title:"加载中"}),this.$http({aurl:"getlotteryDetail",aPath:[this.act_id],success:function(t){console.log(t),e.drawDetail=t.data.result,e.prizeList=t.data.result.lottery_detail},fail:function(t){},complete:function(i){t.hideLoading(),e.show=!0}})},scrollBottom:function(){this.pullUpOn&&(this.page++,this.getRecordLists())},getRecordLists:function(e){var i=this;e&&t.showLoading({title:"加载中"}),this.$http({aurl:"getRecordShowLists",params:{page:this.page,activities_id:this.prizeID},success:function(t){e&&(i.lastPage=t.data.result.lists.last_page);for(var n=0;n<t.data.result.lists.data.length;n++)i.lists.push(t.data.result.lists.data[n]);i.lastPage===i.page&&(i.pullUpOn=!1,i.loadStatus="noMore"),1===t.data.result.lists.last_page&&(i.pullUpOn=!1,i.loadStatus="noMore")},fail:function(t){console.log(t)},complete:function(i){e&&t.hideLoading()}})},toDetail:function(){switch(console.log(this.detail,this.detail.type),this.detail.type){case 3:this.toLink("/pagesB/prize/lists");break;case 4:this.toLink("/pagesA/user/coupon");break}},getRefreshPoint:function(){var t=this;this.$http({aurl:"refreshPoint",data:{gm_id:this.gm_id||1},success:function(e){0===e.data.code&&(t.point=e.data.result.point)},fail:function(t){console.log(t)},complete:function(){}})},handleActionStart:function(){console.log("抽奖开始"),this.getPrize()},getPrize:function(){var t=this,e={gm_id:this.gm_id};this.act_id&&(e.lottery_id=this.act_id),this.$http({aurl:"luckDraw",params:e,success:function(e){0===e.data.code?(t.detail=e.data.result,t.$refs.raffleWheel.lottery(t.detail)):t.$refs.raffleWheel.initFlag(),console.log(e)},fail:function(e){t.$refs.raffleWheel.initFlag()},complete:function(t){}})},handleActionEnd:function(){this.getRefreshPoint(),this.succShow=!0,this.getRecordLists(!0)},getLists:function(){var e=this,i=this.gm_id;t.showLoading({title:"加载中"}),this.$http({aurl:"lotteryLists",data:{gm_id:i},success:function(t){console.log(t.data.result),t.data.result.length>0&&(e.prizeList=t.data.result)},fail:function(t){console.log(t)},complete:function(i){t.hideLoading(),e.show=!0}})},getDesc:function(){var e=this,i=this.gm_id;this.$http({aurl:"lotteryDetail",data:{gm_id:i},needErrTips:!1,success:function(t){e.drawDetail=t.data.result,e.prizeID=e.drawDetail.id,console.log(e.drawDetail),e.getRecordLists(!0)},fail:function(e){console.log(e),t.showModal({title:"温馨提示",content:e.message,showCancel:!1,confirmColor:"#5C6F97",success:function(e){e.confirm?t.navigateBack():e.cancel}})},complete:function(t){}})}}};e.default=c}).call(this,i("543d")["default"])},b03a:function(t,e,i){"use strict";i.r(e);var n=i("f2e3"),a=i("ea92");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("e546");var s,c=i("f0c5"),l=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,"78dded19",null,!1,n["a"],s);e["default"]=l.exports},e546:function(t,e,i){"use strict";var n=i("a76f"),a=i.n(n);a.a},ea92:function(t,e,i){"use strict";i.r(e);var n=i("aecf"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},f2e3:function(t,e,i){"use strict";var n,a=function(){var t=this,e=t.$createElement;t._self._c},o=[];i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}))}},[["7f5e","common/runtime","common/vendor"]]]);