require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesB/activity/couponList"],{5533:function(t,n,e){"use strict";(function(t){e("cf0c");i(e("66fd"));var n=i(e("9d13"));function i(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])},"9d13":function(t,n,e){"use strict";e.r(n);var i=e("e8c6"),o=e("fa9e");for(var a in o)"default"!==a&&function(t){e.d(n,t,(function(){return o[t]}))}(a);e("a981");var u,s=e("f0c5"),c=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"6d4f6192",null,!1,i["a"],u);n["default"]=c.exports},a981:function(t,n,e){"use strict";var i=e("f6b2"),o=e.n(i);o.a},c010:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(e("669a"));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(){Promise.all([e.e("common/vendor"),e.e("components/user/coupon")]).then(function(){return resolve(e("3740"))}.bind(null,e)).catch(e.oe)},u=function(){e.e("components/lists/nullData").then(function(){return resolve(e("0bb9"))}.bind(null,e)).catch(e.oe)},s=function(){e.e("node-modules/_@dcloudio_uni-ui@1.2.5@@dcloudio/uni-ui/lib/uni-load-more/uni-load-more").then(function(){return resolve(e("fdd7"))}.bind(null,e)).catch(e.oe)},c={mixins:[i.default],onLoad:function(n){n.gm_id?this.gm_id=n.gm_id:this.gm_id=t.getStorageSync("gmToken")},onShow:function(){var n=t.getStorageSync("user_token");this.apiUrl=n?"couponCentreLogin":"couponCentre",this.getCouponTab()},onShareAppMessage:function(){return{title:"快来领取优惠吧！",desc:"",path:"/pagesB/activity/couponList?gm_id="+this.gm_id}},onReachBottom:function(){var t=this,n=this.tabList[this.currentIndex];n.onPull&&(n.currentPage===n.lastPage?(n.loadStatus="noMore",n.onPull=!1):(n.loadStatus="loading",n.currentPage++,setTimeout((function(){t.getList(t.tab[t.currentIndex].all_platform,t.tab[t.currentIndex].class_id),n.loadStatus="more"}),1e3)))},mounted:function(){},data:function(){return{gm_id:"",apiUrl:"",isShow:!1,list:[],tab:[],currentIndex:0,tabList:[]}},methods:{showInfo:function(t){this.tabList[this.currentIndex].list[t].isShow=!this.tabList[this.currentIndex].list[t].isShow},getCP:function(n,e){var i=this;this.$http({aurl:"getCoupon",data:{coupon_id:n,gm_id:this.gm_id},success:function(n){0===n.data.code&&(i.tabList[i.currentIndex].list.splice(e,1),t.showToast({title:"领取成功",icon:"none"}),0===i.tabList[i.currentIndex].list.length&&(i.tabList[i.currentIndex].isNull=!0))},fail:function(t){console.log(t)}})},getList:function(t,n,e){var i=this,o={size:10,coupon_scenes:this.tab[this.currentIndex].coupon_scenes,page:this.tabList[this.currentIndex].currentPage,gm_id:this.gm_id};t?o.all_platform=!0:o.class_id=n||"",this.$http({aurl:this.apiUrl,data:o,success:function(t){var n=t.data.result.data,o=i.tabList[i.currentIndex];if(e&&(o.lastPage=t.data.result.last_page,o.init=!0,o.currentPage===o.lastPage&&(o.onPull=!1,o.loadStatus="noMore")),n.length>0){var a=[];n.forEach((function(t,n){t.isShow=!1,a.push(t)})),o.list=e?a:o.list.concat(a)}else o.isNull=!0},fail:function(t){console.log(t)}})},getCouponTab:function(){var t=this;this.$http({aurl:"getCouponTab",data:{gm_id:this.gm_id},success:function(n){var e=n.data.result;t.tab=e,e.forEach((function(n){t.tabList.push({list:[],currentPage:1,lastPage:1,onPull:!0,isNull:!1,init:!1,loadStatus:"loading",item:n})})),t.getList(!1,"",!0)},fail:function(t){console.log(t)}})},changeTab:function(t){var n=t.currentTarget.dataset.index,e=this.tab[n].all_platform,i=this.tab[n].class_id;this.currentIndex=n,this.tabList[n].init||this.getList(e,i,!0)}},components:{couponItem:a,nullData:u,uniLoadMore:s}};n.default=c}).call(this,e("543d")["default"])},e8c6:function(t,n,e){"use strict";var i,o=function(){var t=this,n=t.$createElement;t._self._c},a=[];e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return a})),e.d(n,"a",(function(){return i}))},f6b2:function(t,n,e){},fa9e:function(t,n,e){"use strict";e.r(n);var i=e("c010"),o=e.n(i);for(var a in i)"default"!==a&&function(t){e.d(n,t,(function(){return i[t]}))}(a);n["default"]=o.a}},[["5533","common/runtime","common/vendor"]]]);