require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesB/activity/seckillDetail"],{"004f":function(t,e,o){"use strict";var n,i=function(){var t=this,e=t.$createElement,o=(t._self._c,JSON.stringify(t.detail));t.$mp.data=Object.assign({},{$root:{g0:o}})},a=[];o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}))},"0b81":function(t,e,o){"use strict";var n=o("73bc"),i=o.n(n);i.a},"544c":function(t,e,o){"use strict";o.r(e);var n=o("004f"),i=o("a5d2");for(var a in i)"default"!==a&&function(t){o.d(e,t,(function(){return i[t]}))}(a);o("0b81");var s,u=o("f0c5"),c=Object(u["a"])(i["default"],n["b"],n["c"],!1,null,"14d95478",null,!1,n["a"],s);e["default"]=c.exports},"73bc":function(t,e,o){},"92d4":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(o("0cb3")),i=c(o("2704")),a=c(o("1d66")),s=c(o("ed4a")),u=c(o("669a"));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(){o.e("components/tag/tag").then(function(){return resolve(o("e41d"))}.bind(null,o)).catch(o.oe)},r=function(){o.e("components/tag/coupon").then(function(){return resolve(o("8253"))}.bind(null,o)).catch(o.oe)},d=function(){o.e("components/bottom-popup/bottom-popup").then(function(){return resolve(o("b022"))}.bind(null,o)).catch(o.oe)},f=function(){o.e("components/numberbox/numberbox").then(function(){return resolve(o("5a8b"))}.bind(null,o)).catch(o.oe)},h=function(){o.e("components/header/ToHome").then(function(){return resolve(o("a5c4"))}.bind(null,o)).catch(o.oe)},p=function(){o.e("node-modules/_@dcloudio_uni-ui@1.2.5@@dcloudio/uni-ui/lib/uni-count-down/uni-count-down").then(function(){return resolve(o("b840"))}.bind(null,o)).catch(o.oe)},g=function(){Promise.all([o.e("common/vendor"),o.e("node-modules/_@dcloudio_uni-ui@1.2.5@@dcloudio/uni-ui/lib/uni-popup/uni-popup")]).then(function(){return resolve(o("39db"))}.bind(null,o)).catch(o.oe)},m={name:"detail",mixins:[a.default,s.default,u.default],components:{EmTag:l,TagCoupon:r,tuiBottomPopup:d,tuiNumberbox:f,toHome:h,uniCountdown:p,uniPopup:g},data:function(){return{groups:[],showCouponPopup:!1,height:64,top:0,scrollH:0,popupShow:!1,detail:{},carouselList:i.default.goodsDetail.images,bannerIndex:0,goodsContent:i.default.goodsDetail.content,headTab:[],selectedTab:0,value:1,rateLists:[],coupon_list:[],sku:[],skuLists:[],skuKey:"",goodsSkuItem:{},isSeckill:!1,isGroup:!1,isIntegral:!1,point:0,downSecond:0,downPay:0,seckillInfo:[],couponShowInfo:[],btnIfLists:[],goods_id:0,group_id:0,groupsNum:0,payTypeGroup:!0,skuIndex:0,cartNum:0,seckParam:{},seckParams:{},seckStatus:0,goIng:59,goIngTime:null,tryTime:null,payTime:!1,goPayFlat:!1}},onReady:function(){},onLoad:function(e){var o=this;for(var n in e)this.seckParam[n]=e[n];this.seckParams=Object.assign({},this.seckParam),delete this.seckParams.goods_id;var i={};i=wx.getMenuButtonBoundingClientRect(),t.getSystemInfo({success:function(t){o.width=i.left||t.windowWidth,o.height=i.top?i.top+i.height+8:t.statusBarHeight+44,o.top=i.top?i.top+(i.height-32)/2:t.statusBarHeight+6,o.scrollH=t.windowWidth}})},watch:{},computed:{},onShow:function(){JSON.stringify(t.getStorageSync("seckillSuccess"))===JSON.stringify(this.seckParams)?this.getDetails(!0):this.getDetails(),t.showLoading({title:"加载中..."});var e=t.getStorageSync("user_token");e?this.getCartNum():this.cartNum=0},methods:{getCartNum:function(){var t=this;this.$http({aurl:"getCarNum",success:function(e){t.cartNum=e.data.result.num},fail:function(t){console.log(t)}})},getTime:function(t){var e=n.default.toTimeStamp(n.default.toFullTime())/1e3,o=n.default.toTimeStamp(t)/1e3;return o-e},couponDetail:function(t){this.$set(this.couponShowInfo,t,!this.couponShowInfo[t])},timeUp:function(){t.showToast({title:"活动结束,下次早点来",icon:"none"})},payTimeUp:function(){t.showToast({title:"超过时间未下单",icon:"none"}),this.payTime=!0,t.removeStorageSync("seckillPayTime"),t.removeStorageSync("seckillSuccess"),this.getDetails()},getDetails:function(e){var o=this;this.$http({aurl:"seckillDetails",data:this.seckParam,success:function(i){if(0===i.data.code){var a=new RegExp("<img","gi"),s=i.data.result.goods_body.replace(a,'<img style="max-width: 100%; display:block"');i.data.result.goods_body=s,o.detail=i.data.result;var u=n.default.toTimeStamp(n.default.toFullTime())/1e3,c=n.default.toTimeStamp(o.detail.end_time)/1e3;o.downSecond=c-u,e?(o.seckStatus=5,o.downPay=t.getStorageSync("seckillPayTime")-n.default.toTimeStamp(n.default.toFullTime())/1e3):o.seckStatus=i.data.result.is_sec_kill}},error:function(t){console.log(res)},complete:function(){t.hideLoading()}})},inSeckill:function(){var e=this;if(this.goPayFlat)setTimeout((function(){e.goPayFlat=!1}),1e3);else{this.goPayFlat=!0;var o=t.getStorageSync("user_token");o?this.$http({aurl:"secKillStore",data:this.seckParams,success:function(t){0===t.data.code&&(e.$refs.seckpop.open(),e.seckWiat(),e.goIngTime=setInterval((function(){e.goIng>0?e.goIng--:(clearInterval(e.goIngTime),e.seckStatus=4)}),1e3),e.tryTime=setInterval((function(){e.goIng>=3?e.seckWiat():clearInterval(e.tryTime)}),3e3))},error:function(t){console.log(t)}}):this.toLink("/pagesA/user/bindUser")}},seckWiat:function(){var e=this,o=this.detail.seckill_wait_time;this.$http({aurl:"secKillWait",data:this.seckParams,success:function(i){1===i.data.result.pass&&(e.seckStatus=5,clearInterval(e.tryTime),clearInterval(e.goIngTime),t.setStorageSync("seckillSuccess",e.seckParams),t.setStorageSync("seckillPayTime",n.default.toTimeStamp(n.default.toFullTime())/1e3+60*o),e.payTime&&(e.downPay=t.getStorageSync("seckillPayTime")-n.default.toTimeStamp(n.default.toFullTime())/1e3),e.$refs.seckpop.close(),t.navigateTo({url:"/pagesA/checkout/index?isSeck=fastbuy"}))},error:function(t){console.log(t)}})},goPay:function(){t.navigateTo({url:"/pagesA/checkout/index?isSeck=fastbuy"})},closeSeckill:function(){this.$refs.seckpop.close(),this.goIng>0&&(this.seckStatus=3)},bannerChange:function(t){this.bannerIndex=t.detail.current},change:function(t){this.value=t.value},hidePopup:function(){this.popupShow=!1},showPopup:function(t){this.isGroup?(this.goodsSkuItem=t?this.detail.group_spec_list[this.skuIndex]:this.detail.spec_list[this.skuIndex],this.payTypeGroup=t,this.popupShow=!0):this.popupShow=!0},favoriteToggle:function(e,o){var n=this;this.$http({aurl:e,data:{goods_id:this.detail.id,gm_id:this.seckParam.gm_id},success:function(e){n.detail.is_favorite=!n.detail.is_favorite,t.showToast({title:o})},fail:function(t){}})}},destroyed:function(){clearInterval(this.goIngTime),clearInterval(this.tryTime)}};e.default=m}).call(this,o("543d")["default"])},9440:function(t,e,o){"use strict";(function(t){o("cf0c");n(o("66fd"));var e=n(o("544c"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},a5d2:function(t,e,o){"use strict";o.r(e);var n=o("92d4"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a}},[["9440","common/runtime","common/vendor"]]]);