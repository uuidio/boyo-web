(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/selectSku/selectSku"],{4261:function(t,s,i){"use strict";var e=i("ee70"),o=i.n(e);o.a},"6218f":function(t,s,i){"use strict";i.r(s);var e=i("f666"),o=i("6b55");for(var u in o)"default"!==u&&function(t){i.d(s,t,(function(){return o[t]}))}(u);i("4261");var n,a=i("f0c5"),l=Object(a["a"])(o["default"],e["b"],e["c"],!1,null,"46cddb37",null,!1,e["a"],n);s["default"]=l.exports},"6b55":function(t,s,i){"use strict";i.r(s);var e=i("9c9a"),o=i.n(e);for(var u in e)"default"!==u&&function(t){i.d(s,t,(function(){return e[t]}))}(u);s["default"]=o.a},"9c9a":function(t,s,i){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var e=function(){i.e("components/bottom-popup/bottom-popup").then(function(){return resolve(i("b022"))}.bind(null,i)).catch(i.oe)},o=function(){i.e("components/numberbox/numberbox").then(function(){return resolve(i("5a8b"))}.bind(null,i)).catch(i.oe)},u={name:"selectGoods",components:{tuiBottomPopup:e,tuiNumberbox:o},props:{goodsId:[Number,String],value:Boolean},watch:{value:function(t){this.showPopup=t},showPopup:function(t){this.$emit("input",this.showPopup)},goodsId:function(t){this.getGoodsDetail([t])},detail:function(t){console.log(t),this.initSku()}},data:function(){return{detail:{},showPopup:!1,goodsSkuItem:{},sku:[],skuKey:"",skuSelect:[],skuImgUrl:"",numberValue:1,skuImgs:[],goodsLoading:!1,groups:[],skuLists:[],isSeckill:!1,isGroup:!1,isIntegral:!1,isVirtual:!1,point:0,group_id:0,groupsNum:0,payTypeGroup:!0,skuIndex:0,goodsStocks:0}},methods:{payClick:function(s,i){var e=t.getStorageSync("user_token");if(e)if(-1===this.skuSelect.indexOf("占位")){i?this.group_id=0:this.isGroup&&(console.log(this.goodsSkuItem),this.goodsSkuItem=this.detail.group_spec_list[this.skuIndex],this.goodsSkuItem.group_activty_id&&(this.group_id=this.goodsSkuItem.group_activty_id));var o={quantity:this.numberValue,type:s,sku_id:"",is_checked:1};if(this.isSeckill){var u=this.detail.sec_kill_info[0].seckill_ap_id;o.actSign="seckill",o.activity_id=u}this.isGroup&&0!==this.group_id&&(o.actSign="is_group",o.activity_id=this.group_id),this.isIntegral&&(o.actSign="point_goods"),null===this.detail.goods_spec?o.sku_id=this.detail.spec_list[0].id:o.sku_id=this.goodsSkuItem.id,console.log(s,o),this.addCart(s,o),this.showPopup=!1,this.initSku()}else t.showToast({title:"请选择完商品规格",icon:"none"});else this.toLink("/pagesA/user/bindUser")},addCart:function(s,i){var e=this;this.$http({aurl:"addCart",data:i,success:function(i){if("cart"===s)t.showToast({title:"加入购物车成功"}),e.$emit("addCartOK");else{var o=e;t.setStorage({key:"type",data:"fastbuy",success:function(){o.needTokenLink("/pagesA/checkout/index")}})}},fail:function(s){t.showToast({title:s.message.msg,icon:"none"}),console.log(s)}})},hidePopup:function(){this.showPopup=!1},change:function(t){this.numberValue=t.value},getGoodsDetail:function(s){var i=this;t.showLoading({title:"加载中"}),this.$http({aurl:"getGoodsDetail",aPath:s,success:function(s){i.detail=s.data.result,i.goodsStocks=0,i.detail.spec_list.forEach((function(t){i.goodsStocks+=Number(t.goods_stock)})),i.isSeckill=1==s.data.result.is_sec_kill,i.isGroup=1==s.data.result.is_group,i.isVirtual=1==s.data.result.is_virtual,t.hideLoading(),i.goodsLoading=!0,i.showPopup=!0},fail:function(t){console.log(t)}})},getGroupOrder:function(){var t=this;this.$http({aurl:"groupGoodsOrder",params:{id:this.goodId},success:function(s){t.groups=s.data.result.list,t.groupsNum=s.data.result.now_join_group},fail:function(t){console.log(t)}})},skuActive:function(t,s,i){var e=this.detail.spec_name.indexOf("颜色");e===t&&(this.skuImgs[s]&&this.skuImgs[s].length>0&&(this.skuImgUrl=this.skuImgs[s][0].url),console.log(this.skuImgUrl)),this.sku[t].active=s,this.skuSelect[t]=i,console.log(this.sku,this.skuSelect),this.skuActiveChange()},skuActiveChange:function(){if(-1===this.skuSelect.indexOf("占位")){this.skuKey="";var t=this;this.skuSelect.forEach((function(s){t.skuKey+=s+"_"})),t.skuKey=t.skuKey.slice(0,t.skuKey.length-1),this.skuIndex=this.skuLists.indexOf(t.skuKey),this.isGroup?this.goodsSkuItem=this.detail.group_spec_list[this.skuIndex]:this.goodsSkuItem=this.detail.spec_list[this.skuIndex],this.goodsSkuItem.group_activty_id?this.group_id=this.goodsSkuItem.group_activty_id:this.group_id=0,this.numberValue=1}},initSku:function(){if(this.sku=[],this.skuKey="",this.skuSelect=[],this.isGroup){var t=this.detail.group_spec_list.filter((function(t){return t.group_activty_id}));this.goodsSkuItem=t[0],console.log(this.goodsSkuItem),this.group_id=this.goodsSkuItem.group_activty_id}else this.goodsSkuItem=this.detail.spec_list[0];if(this.numberValue=1,null!==this.detail.goods_spec){for(var s=0;s<this.detail.spec_name.length;s++){var i={title:"",lists:[],active:-1};if(i.title=this.detail.spec_name[s],this.detail.goods_spec[s].value)for(var e=0;e<this.detail.goods_spec[s].value.length;e++)i.lists.push(this.detail.goods_spec[s].value[e]);else for(var o=0;o<this.detail.goods_spec[s].length;o++)i.lists.push(this.detail.goods_spec[s][o]);"颜色"===this.detail.spec_name[s]&&this.detail.goods_spec[s].imgs&&(this.skuImgs=this.detail.goods_spec[s].imgs),this.sku.push(i),this.skuSelect.push("占位")}for(var u=0;u<this.detail.spec_list.length;u++)this.skuLists.push(this.detail.spec_list[u].spec_sign);console.log(this.goodsSkuItem)}}}};s.default=u}).call(this,i("543d")["default"])},ee70:function(t,s,i){},f666:function(t,s,i){"use strict";var e,o=function(){var t=this,s=t.$createElement;t._self._c},u=[];i.d(s,"b",(function(){return o})),i.d(s,"c",(function(){return u})),i.d(s,"a",(function(){return e}))}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/selectSku/selectSku-create-component',
    {
        'components/selectSku/selectSku-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("6218f"))
        })
    },
    [['components/selectSku/selectSku-create-component']]
]);
