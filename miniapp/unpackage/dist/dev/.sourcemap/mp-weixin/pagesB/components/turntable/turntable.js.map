{"version":3,"sources":["webpack:////Users/huangdahao/Desktop/web/smartconns_go/miniapp/pagesB/components/turntable/turntable.vue?91fd","webpack:////Users/huangdahao/Desktop/web/smartconns_go/miniapp/pagesB/components/turntable/turntable.vue?afa5","webpack:////Users/huangdahao/Desktop/web/smartconns_go/miniapp/pagesB/components/turntable/turntable.vue?1d48","webpack:////Users/huangdahao/Desktop/web/smartconns_go/miniapp/pagesB/components/turntable/turntable.vue?167e","uni-app:///pagesB/components/turntable/turntable.vue","webpack:////Users/huangdahao/Desktop/web/smartconns_go/miniapp/pagesB/components/turntable/turntable.vue?c695","webpack:////Users/huangdahao/Desktop/web/smartconns_go/miniapp/pagesB/components/turntable/turntable.vue?8b10"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkI;AAClI;AAC6D;AACL;AACsC;;;AAG9F;AACsN;AACtN,gBAAgB,iNAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,gGAAM;AACR,EAAE,yGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAq2B,CAAgB,uyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;ACYz3B,oE;AACA;AACA;AACA;AACA;AACA,kBADA;AAEA,oBAFA,EAFA;;AAMA;AACA;AACA,kBADA;AAEA,oBAFA,EAPA;;AAWA;AACA;AACA,iBADA;AAEA,oBAFA,EAZA;;AAgBA;AACA;AACA,kBADA;AAEA,oBAFA,EAjBA;;AAqBA;AACA;AACA,kBADA;AAEA,oBAFA,EAtBA,EADA;;;AA4BA,MA5BA,kBA4BA;AACA;AACA,iBADA;AAEA,uBAFA;AAGA,wBAHA;AAIA,qBAJA;AAKA,wBALA;AAMA,qBANA;AAOA,sBAPA;;AASA,GAtCA;AAuCA,SAvCA,qBAuCA;AACA;AACA;AACA;AACA;AACA,OAHA,EAGA,GAHA;AAIA,KALA;AAMA,GA9CA;AA+CA,iCA/CA;AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BALA;AAMA,SANA;AAOA;AACA,+CADA;AAEA;AACA;AACA,aAJA;AAKA,gBALA,gBAKA,GALA,EAKA;AACA;AACA,aAPA;AAQA;AACA;AACA;AACA;AACA;AACA,aAbA,IAPA,EAMA;;AAgBA;AACA,OAvBA;AAwBA,UAxBA,CAwBA;AACA;AACA;AACA,qBADA;AAEA,8BAFA;AAGA,6BAHA;AAIA,6BAJA;AAKA,sBALA;AAMA,wBANA;AAOA;AACA,4BADA,CACA;AADA,WAPA;AAUA;AACA,4BADA,CACA;AADA,WAVA;AAaA,sCAbA,EAaA;AACA;AACA,sCAfA,EAeA;AACA;AACA;AACA;AACA,4BADA;AAEA,8BAFA;AAGA,0BAHA,EAlBA;;;AAwBA,OAlDA;AAmDA,WAnDA,CAmDA;AACA;AACA;AACA,OAtDA;AAuDA,KA9DA;AA+DA;AACA,YAhEA,sBAgEA;AACA;AACA;AACA,KAnEA;AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA/EA;AAgFA;AACA,UAjFA,oBAiFA;AACA;AACA;AACA;AACA;AACA,oBADA;AAEA,sBAFA;AAGA,0BAHA;AAIA;AACA;AACA;AACA;AACA;AACA,aAFA,EAEA,GAFA;AAGA;AACA;AACA,SAZA;AAaA,UAbA;AAcA,KAnGA;AAoGA;AACA,WArGA,mBAqGA,MArGA,EAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAHA,EAGA,OAHA;AAIA,OAPA;AAQA,KA5HA,EAhDA,E;;;;;;;;;;;;;ACbA;AAAA;AAAA;AAAA;AAA8kD,CAAgB,y5CAAG,EAAC,C;;;;;;;;;;;ACAlmD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pagesB/components/turntable/turntable.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./turntable.vue?vue&type=template&id=693216ed&scoped=true&\"\nvar renderjs\nimport script from \"./turntable.vue?vue&type=script&lang=js&\"\nexport * from \"./turntable.vue?vue&type=script&lang=js&\"\nimport style0 from \"./turntable.vue?vue&type=style&index=0&id=693216ed&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"693216ed\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pagesB/components/turntable/turntable.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=template&id=693216ed&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=script&lang=js&\"","<template>\n  <view>\n    <view class=\"canvas-container\" :style=\"{width: canvasWidth + 'px', height: canvasHeight + 'px'}\">\n      <canvas v-show=\"canvasShow\" class=\"canvas\" canvas-id=\"canvas\" :style=\"'width:' + canvasWidth + 'px;height:' + canvasHeight + 'px;'\"></canvas>\n      <image v-if=\"!canvasShow\" mode=\"widthFix\" class=\"canvas\" :style=\"'width:' + canvasWidth + 'px;height:' + canvasHeight + 'px;'\" :src=\"ImgPath\"></image>\n      <cover-image v-show=\"canvasShow\" mode=\"widthFix\" src=\"https://ytxspt.ytholidayplaza.com/images/cj-activity/discBtn.png\" class=\"start\" @tap=\"playReward\"></cover-image>\n      <image v-if=\"ImgPath\" class=\"start\" mode=\"widthFix\" src=\"https://ytxspt.ytholidayplaza.com/images/cj-activity/discBtn.png\" @tap=\"playReward\"></image>\n    </view>\n  </view>\n</template>\n\n<script>\n  var turntable = require(\"./lib/turntable.js\");\n  export default {\n    props: {\n      // canvas 宽度\n      canvasWidth: {\n        type: Number,\n        required: true\n      },\n      // canvas 高度\n      canvasHeight: {\n        type: Number,\n        required: true\n      },\n      // 奖品列表\n      prizeList: {\n        type: Array,\n        required: true\n      },\n      // 奖品名称所对应的 key 值\n      strKey: {\n        type: String,\n        required: true\n      },\n      // 奖品图片所对应的 key 值\n      imgKey: {\n        type: String,\n        required: true\n      },\n    },\n    data() {\n      return {\n        ImgPath: '',\n        canvasShow: false,\n        showMyPrize: false,\n        myPrizelist: [],\n        showNoPrize: false,\n        turntable: null,\n        inLottery: false,\n      }\n    },\n    mounted () {\n      this.$nextTick(() => {\n        setTimeout(() => {\n          // 获取奖品列表\n          this.initdata();\n        }, 500)\n      })\n    },\n    onReady: function(e) {},\n    methods: {\n      // 初始化抽奖数据\n      initdata: function() {\n        var that = this;\n        // 画转盘\n        var width = that.canvasWidth;\n        var height = width;\n        return new Promise(function(resolve, reject) {\n          // uni.showLoading({\n          //   title: '数据加载中'\n          // });\n          /*预下载所有的图片保存至本地,否则出现canvas绘制图片跨域,出现空白*/\n          let tempIndex = 0;\n          for (let i = 0; i < that.prizeList.length; i++) {\n            uni.getImageInfo({\n              src: that.prizeList[i][that.imgKey],\n              success: imgInfo => {\n                that.prizeList[i].localimage = imgInfo.path;\n              },\n              fail(err) {\n                console.log('图片加载失败', err);\n              },\n              complete: () => {\n                tempIndex++;\n                if (tempIndex == that.prizeList.length) {\n                  resolve('OK');\n                }\n              }\n            });\n          }\n        })\n        .then(function(r) {\n          uni.hideLoading();\n          that.turntable = turntable.wheelSurf(\"canvas\", {\n              $this: that,\n              list: that.prizeList,\n              strKey: that.strKey,\n              imgKey: that.imgKey,\n              width: width,\n              height: height,\n              outerCircle: {\n                color: '#2F80E8' // 外圈颜色(可选)\n              },\n              innerCircle: {\n                color: '#FBF099' // 里圈颜色(可选)\n              },\n              dots: [\"#FBF0B0\", \"#FFFFFF\"], // 装饰点颜色(可选)\n              // disk: diskColor, //中心奖盘的颜色，默认7彩(可选)\n              disk: [\"#fbf3a6\",\"#2F80E8\"], //中心奖盘的颜色\n              // disk: [\"#FAFAFA\",\"#BCF489\",\"#EFB88E\", \"#EBE993\", \"#82E7D4\",\"#19BD9F\", \"#16B960\"], //中心奖盘的颜色，默认7彩(可选)\n              // disk: [\"#EE904A\", \"#D3D03D\",\"#8AD049\", \"#16B960\",\"#19BD9F\",\"#17ABC1\", \"#EB678D\",\"#F0675D\"], //中心奖盘的颜色，默认7彩(可选)\n              title: {\n                color: '#B14A29',\n                font: '13px Arial',\n                lineHeight: 13\n              }\n          });\n        },)\n        .catch(function(reason) {\n          uni.hideLoading();\n          console.log('Failed: ' + reason);\n        });\n      },\n      // 开启按钮开关及显示图片转盘\n      initFlag(){\n        this.inLottery = false\n        this.canvasShow = false\n      },\n      playReward: function() {\n        const token = uni.getStorageSync('user_token');\n        if (!token) {\n          this.toLink('/pagesB/user/bindUser')\n          return\n        }\n        if (this.inLottery) return\n        this.inLottery = true\n        this.canvasShow = true\n        this.$emit('actionStart')\n        // this.lottery(false);\n      },\n      // 生成图片\n      getImg(init=true){\n        const that = this\n        const width = this.canvasWidth;\n        const height = width;\n        uni.canvasToTempFilePath({\n          width: width,\n          height: height,\n          canvasId: 'canvas',\n          success: function(res) {\n            that.ImgPath = res.tempFilePath\n            if(init) {\n              setTimeout(()=>{\n                that.canvasShow = false\n              },200)\n              that.$emit('actionEnd')\n            }\n          }\n        }, that)\n      },\n      //发起抽奖\n      lottery(detail) {\n        var that = this;\n        var angel = 360 / that.prizeList.length;\n        // 获取奖品\n        var awards = detail;\n        var count = 0;\n        // 计算奖品角度\n        for (var key in that.prizeList) {\n          if (that.prizeList.hasOwnProperty(key)) {\n            if (awards.id == that.prizeList[key].id) {\n              break;\n            }\n            count++;\n          }\n        }\n        that.turntable.lottery(count * angel + angel / 2, function() {\n          // 计算转盘结束对时间，预加一些延迟确保转盘停止后触发结束事件\n          let endTime = 0 * 1000 + 100\n          setTimeout(function(){\n            that.inLottery = false\n            that.getImg()\n          }, endTime)\n        });\n      },\n    }\n  }\n</script>\n<style lang=\"scss\" scoped>\n  /* 转盘 */\n  .canvas-container {\n    position: relative;\n    left: 0;\n    top: 0;\n    margin: 0 auto;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .canvas {\n    // width: 100%!important;\n    position: absolute;\n    // left: -9999px;\n    // opacity: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n  }\n  .start {\n    position: absolute;\n    top: calc(50% - 70rpx);\n    left: calc(50% - 54rpx);\n    width: 108rpx;\n    height: 140rpx;\n    // position: absolute;\n    // top: 250rpx;\n    // left: 50%;\n    // transform:translateX(-50%);\n    // width: 107rpx;\n    // height: 140rpx;\n    // cursor: pointer;\n  }\n</style>\n","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=style&index=0&id=693216ed&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=style&index=0&id=693216ed&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1604546403282\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}